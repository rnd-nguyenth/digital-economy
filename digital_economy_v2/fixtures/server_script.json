[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.321702",
  "module": "Digital Economy V2",
  "name": "[ Digital Economy Index ] Auto naming",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Digital Economy Index",
  "script": "if not doc.du_lieu_nam:\n    doc.title = f\"Bộ chỉ số Kinh tế số {doc.quy}/{doc.nam}\"\nelse:\n    doc.title = f\"Bộ chỉ số Kinh tế số năm {doc.nam}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.379352",
  "module": "Digital Economy V2",
  "name": "[ Industry Name ] Auto-naming",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Industry Name",
  "script": "if not doc.ma_nganh_kinh_te:\n    doc.title =  f\"{doc.nganh_kinh_te}\"\nelse:\n    doc.title = f\"{doc.ma_nganh_kinh_te}. {doc.nganh_kinh_te}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.365153",
  "module": "Digital Economy V2",
  "name": "[ Estimated GRDP ] Auto naming",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Estimated GRDP",
  "script": "if not doc.du_lieu_nam:\n    doc.title = f\"Ước tính {doc.quy}/{doc.nam}\"\nelse: \n    doc.title = f\"Ước tính năm {doc.nam}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.351272",
  "module": "Digital Economy V2",
  "name": "[ VA ICT ] Auto naming",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "VA ICT",
  "script": "if not doc.du_lieu_nam:\n    doc.title = f\"VA ICT {doc.quy}/{doc.nam}\"\nelse:\n    doc.title = f\"VA ICT năm {doc.nam}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.335678",
  "module": "Digital Economy V2",
  "name": "[ GRDP Index ] Auto naming",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "GRDP Index",
  "script": "if not doc.du_lieu_nam:\n    doc.title = f\"Chỉ số Kết quả KTS {doc.quy}/{doc.nam}\"\nelse:\n    doc.title = f\"Chỉ số Kết quả KTS năm {doc.nam}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.257312",
  "module": "Digital Economy V2",
  "name": "Tạo bản ghi Pie Chart tương ứng",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "GRDP Index",
  "script": "if doc.ty_trong_kts_loi:\r\n    # Create the first Pie document for KTS lõi\r\n    pie_doc_1 = frappe.get_doc({\r\n        \"doctype\": \"Pie Chart\",\r\n        \"du_lieu_nam\": doc.du_lieu_nam,\r\n        \"grdp_index\": doc.name,  # Link to GRDP Index\r\n        \"loai_kts\": \"KTS Lõi\",\r\n        \"ty_trong\": doc.ty_trong_kts_loi,  # Fetch from GRDP Index\r\n        \"quy\": doc.quy,\r\n        \"nam\": doc.nam,\r\n        \"thoi_gian\": doc.thoi_gian  # Fetch from GRDP Index\r\n    })\r\n    pie_doc_1.insert()\r\n\r\nif doc.ty_trong_kts_lan_toa:\r\n    # Create the second Pie document for KTS lan toả\r\n    pie_doc_2 = frappe.get_doc({\r\n        \"doctype\": \"Pie Chart\",\r\n        \"du_lieu_nam\": doc.du_lieu_nam,\r\n        \"grdp_index\": doc.name,  # Link to GRDP Index\r\n        \"loai_kts\": \"KTS Lan toả\",\r\n        \"ty_trong\": doc.ty_trong_kts_lan_toa,  # Fetch from GRDP Index\r\n        \"quy\": doc.quy,\r\n        \"nam\": doc.nam,\r\n        \"thoi_gian\": doc.thoi_gian  # Fetch from GRDP Index\r\n    })\r\n    pie_doc_2.insert()\r\n\r\nif doc.ty_trong_kts_loi and doc.ty_trong_kts_lan_toa:\r\n    # Create the third Pie document for remaining percentage (100% - KTS tổng)\r\n    remaining_percentage = 100 - doc.ty_trong_kts_tong\r\n    pie_doc_3 = frappe.get_doc({\r\n        \"doctype\": \"Pie Chart\",\r\n        \"du_lieu_nam\": doc.du_lieu_nam,\r\n        \"grdp_index\": doc.name,  # Link to GRDP Index\r\n        \"loai_kts\": \"\",  # Blank field\r\n        \"ty_trong\": remaining_percentage,  # Calculated from GRDP Index\r\n        \"quy\": doc.quy,\r\n        \"nam\": doc.nam,\r\n        \"thoi_gian\": doc.thoi_gian  # Fetch from GRDP Index\r\n    })\r\n    pie_doc_3.insert()\r\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Delete",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.308956",
  "module": "Digital Economy V2",
  "name": "Xoá bản ghi Pie Chart tương ứng nếu xoá GRDP Index",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "GRDP Index",
  "script": "# Fetch all related Pie documents with the grdp_index as the current GRDP Index document\nrelated_pie_docs = frappe.get_all('Pie Chart', filters={\"grdp_index\": doc.name}, pluck='name')\n\n# Loop through all the related Pie documents and delete them\nfor pie_doc_name in related_pie_docs:\n    frappe.delete_doc('Pie Chart', pie_doc_name)",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-27 15:23:41.294197",
  "module": "Digital Economy V2",
  "name": "Update bản ghi Pie Chart nếu có thay đổi",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "GRDP Index",
  "script": "# Check if Pie Chart documents already exist\r\nexisting_pie_loi = frappe.get_all(\"Pie Chart\", filters={\"grdp_index\": doc.name, \"loai_kts\": \"KTS Lõi\"}, limit=1)\r\nexisting_pie_lan_toa = frappe.get_all(\"Pie Chart\", filters={\"grdp_index\": doc.name, \"loai_kts\": \"KTS Lan toả\"}, limit=1)\r\nexisting_pie_tong = frappe.get_all(\"Pie Chart\", filters={\"grdp_index\": doc.name, \"loai_kts\": \"\"}, limit=1)\r\n\r\n# If documents exist, update them\r\n\r\n# First Pie Chart document for KTS lõi\r\nif existing_pie_loi:\r\n    pie_doc = frappe.get_doc(\"Pie Chart\", existing_pie_loi[0].name)\r\n    pie_doc.ty_trong = doc.ty_trong_kts_loi\r\n    pie_doc.save()\r\n\r\n# Second Pie Chart document for KTS lan toả\r\nif existing_pie_lan_toa:\r\n    pie_doc = frappe.get_doc(\"Pie Chart\", existing_pie_lan_toa[0].name)\r\n    pie_doc.ty_trong = doc.ty_trong_kts_lan_toa\r\n    pie_doc.save()\r\n\r\n# Third Pie Chart document for remaining percentage (100% - KTS tổng)\r\nif existing_pie_tong:\r\n    pie_doc = frappe.get_doc(\"Pie Chart\", existing_pie_tong[0].name)\r\n    pie_doc.ty_trong = 100 - doc.ty_trong_kts_tong\r\n    pie_doc.save()",
  "script_type": "DocType Event"
 }
]